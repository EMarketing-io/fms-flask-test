<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>FMS Intake</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    body{font-family:sans-serif;max-width:820px;margin:2rem auto;padding:0 1rem}
    .card{background:#fff;border:1px solid #ddd;border-radius:12px;padding:20px;box-shadow:0 6px 16px rgba(0,0,0,.06)}
    label{font-weight:700;display:block;margin:.6rem 0 .2rem}
    input,select{width:100%;padding:.6rem;border-radius:8px;border:1px solid #ccc}
    button{margin-top:1rem;width:100%;padding:.9rem;border-radius:10px;border:0;background:#f56;color:#fff;font-weight:700}
  </style>
</head>
<body>
  <h1>ğŸ—‚ï¸ FMS Master Sheet â€” Intake</h1>
  {% with msgs=get_flashed_messages() %}
    {% if msgs %}
      <div style="color:#b00;margin:.8rem 0">{{ msgs[0] }}</div>
    {% endif %}
  {% endwith %}
  <div class="card">
    <form method="POST" enctype="multipart/form-data">
      <label>ğŸ—“ï¸ Meeting Date</label>
      <input type="date" name="meeting_date" required />

      <label>ğŸ·ï¸ Client Name</label>
      <select name="client_name" required>
        {% for c in clients %}<option value="{{c}}">{{c}}</option>{% endfor %}
      </select>

      <label>ğŸ“Œ Meeting Type</label>
      <select name="meeting_type">
        <option>Regular</option><option>Kickstart</option>
      </select>

      <label>ğŸ‘¤ Submitted By</label>
      <select name="submitted_by" id="submitted_by">
        {% for n in employee_names %}<option value="{{n}}">{{n}}</option>{% endfor %}
      </select>

      <label>âœ‰ï¸ Email (auto)</label>
      <input type="text" id="email_id" disabled />

      <label>ğŸŒ Website Link (optional)</label>
      <input type="url" name="website_link" placeholder="https://example.com" />

      <label>ğŸ™ï¸ Meeting Audio (multi .m4a/.mp3/.wav)</label>
      <input type="file" name="audio_files" accept=".m4a,.mp3,.wav" multiple required />

      <button type="submit">ğŸš€ Submit</button>
    </form>
  </div>
  <script>
    const map = {{ employee_email_map|tojson }};
    const sel = document.getElementById('submitted_by');
    const email = document.getElementById('email_id');
    function upd(){ email.value = map[sel.value] || ''; }
    sel.addEventListener('change', upd); upd();
  </script>
</body>
</html>
